<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Browse SVGs — helper</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    body { padding: 1rem; }
    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px,1fr)); gap: 1rem; }
    .card { background: var(--card-bg); border: 1px solid var(--border); border-radius: 8px; padding: 0.5rem; display:flex; flex-direction:column; gap:0.5rem; }
    .thumb { height: 160px; display:flex; align-items:center; justify-content:center; background: #fff; border-radius:4px; overflow:hidden; }
    .code-view { height:160px; overflow:auto; background:#fff; border-radius:4px; padding:0.5rem; font-family: monospace; font-size:0.75rem; white-space: pre; }
    .card .meta { font-size:0.85rem; color: #555; }
    .card .actions { display:flex; gap:0.4rem; justify-content:space-between; }
    .topbar { display:flex; gap:0.5rem; margin-bottom:1rem; align-items:center; }
    .search { flex:1; }
  </style>
</head>
<body>
  <header style="display:flex; align-items:center; gap:1rem; margin-bottom:1rem;">
    <h2 style="margin:0">Browse SVGs (svgviewer.dev)</h2>
    <small style="color:#666">Quick helper to preview and import remote SVGS</small>
  </header>

  <div class="topbar">
    <input id="inputId" class="search" placeholder="Enter svgviewer id (e.g. 13341) or full URL" />
    <button id="addBtn" class="small">Add</button>
    <button id="reloadBtn" class="small secondary">Reload Thumbnails</button>
  </div>

  <div id="notice" role="status" aria-live="polite" style="margin-bottom:0.5rem;color:#444"></div>

  <div id="grid" class="grid"></div>

  <script>
    // Sample IDs (starting with the requested 13341)
    const sampleIds = [13341, 13340, 13339, 13000, 12888, 12012, 11001, 10999];

    const grid = document.getElementById('grid');
    const notice = document.getElementById('notice');

    function svgUrlForId(id) {
      // svgviewer serves the raw SVG at /s/:id
      return `https://www.svgviewer.dev/s/${encodeURIComponent(id)}`;
    }

    function makeCardFor(url, label) {
      const card = document.createElement('div'); card.className = 'card';
      const thumb = document.createElement('div'); thumb.className = 'thumb';
      const codeView = document.createElement('pre'); codeView.className = 'code-view';
      codeView.textContent = 'Click "Load Code" to fetch SVG source...';
      thumb.appendChild(codeView);
      card.appendChild(thumb);

      const meta = document.createElement('div'); meta.className = 'meta';
      meta.textContent = label || url;
      card.appendChild(meta);

      const actions = document.createElement('div'); actions.className = 'actions';

      const left = document.createElement('div'); left.style.display='flex'; left.style.gap='0.4rem';
      const loadBtn = document.createElement('button'); loadBtn.className='small'; loadBtn.textContent='Load Code';
      loadBtn.onclick = async () => {
        try {
          codeView.textContent = 'Fetching...';
          const res = await fetch(url);
          if (!res.ok) throw new Error('Fetch failed: ' + res.status);
          const text = await res.text();
          codeView.textContent = text;
        } catch (err) {
          codeView.textContent = 'Error fetching SVG: ' + err.message + '\nOpen in new tab to inspect.';
        }
      };
      const copyBtn = document.createElement('button'); copyBtn.className='small secondary'; copyBtn.textContent='Copy URL';
      copyBtn.onclick = async () => { await navigator.clipboard.writeText(url); notice.textContent = 'Copied URL to clipboard'; setTimeout(()=>notice.textContent='','1200'); };
      left.appendChild(loadBtn); left.appendChild(copyBtn);


      const right = document.createElement('div'); right.style.display='flex'; right.style.gap='0.4rem';
      const dlBtn = document.createElement('button'); dlBtn.className='small'; dlBtn.textContent='Download';
      dlBtn.onclick = async () => {
        try {
          notice.textContent = 'Downloading...';
          const res = await fetch(url);
          if (!res.ok) throw new Error('Fetch failed');
          const blob = await res.blob();
          const a = document.createElement('a');
          const u = URL.createObjectURL(blob);
          a.href = u; a.download = (label ? label.replace(/[^a-z0-9]/gi,'_') : 'svg') + '.svg';
          document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(u);
          notice.textContent = 'Downloaded'; setTimeout(()=>notice.textContent='','1000');
        } catch (err) {
          notice.textContent = 'Download failed — opening in new tab';
          window.open(url, '_blank');
        }
      };

      const useBtn = document.createElement('button'); useBtn.className='small secondary'; useBtn.textContent='Use in App';
      useBtn.onclick = async () => {
        // Copy URL to clipboard and open index page
        try { await navigator.clipboard.writeText(url); } catch (e) {}
        notice.textContent = 'URL copied — open Index and paste into SVG input';
        window.open('index.html','_blank');
      };

      right.appendChild(dlBtn); right.appendChild(useBtn);

      actions.appendChild(left); actions.appendChild(right);
      card.appendChild(actions);
      return card;
    }

    function renderList(ids) {
      grid.innerHTML = '';
      ids.forEach(id => {
        const url = typeof id === 'string' && id.startsWith('http') ? id : svgUrlForId(id);
        const card = makeCardFor(url, `svgviewer:${id}`);
        grid.appendChild(card);
      });
    }

    document.getElementById('addBtn').addEventListener('click', () => {
      const val = document.getElementById('inputId').value.trim();
      if (!val) return;
      // Accept raw URL or id
      const entry = val.match(/^https?:/i) ? val : parseInt(val,10) || val;
      sampleIds.unshift(entry);
      renderList(sampleIds.slice(0,40));
      document.getElementById('inputId').value = '';
    });

    document.getElementById('reloadBtn').addEventListener('click', () => renderList(sampleIds));

    // initial render
    renderList(sampleIds);
  </script>
</body>
</html>
